{"ast":null,"code":"import _defineProperty from\"/Users/gabsacs/Desktop/Group1/src/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/gabsacs/Desktop/Group1/src/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/gabsacs/Desktop/Group1/src/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/gabsacs/Desktop/Group1/src/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/gabsacs/Desktop/Group1/src/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/gabsacs/Desktop/Group1/src/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/gabsacs/Desktop/Group1/src/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/gabsacs/Desktop/Group1/src/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{Link}from'react-router-dom';var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);function Login(props){var _this;_classCallCheck(this,Login);_this=_possibleConstructorReturn(this,_getPrototypeOf(Login).call(this));_this.handleSubmit=function(event){event.preventDefault();_this.setState({error_msg:null});fetch('/api/user/login',{method:'post',credentials:'include',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:_this.state.username,password:_this.state.password})}).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){var body;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return res.json();case 2:body=_context.sent;if(res.ok){_context.next=5;break;}return _context.abrupt(\"return\",_this.setState({error_msg:body.message}));case 5:_this.setState({logged_in:true});_this.props.onLogin(body);// user\ncase 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(err){console.error(err);});};_this.state={username:'test_user',password:'AbsoluteUnit1134!',error_msg:null,logged_in:props.logged_in||false};return _this;}_createClass(Login,[{key:\"componentDidUpdate\",value:function componentDidUpdate(){if(this.state.logged_in){this.props.history.push('/');}}},{key:\"onChange\",value:function onChange(attr,event){this.setState(_defineProperty({},attr,event.target.value));}},{key:\"render\",value:function render(){var _this2=this;var form=React.createElement(\"form\",{onSubmit:this.handleSubmit},React.createElement(\"div\",{className:\"form-row\"},React.createElement(\"div\",{className:\"col-12 mb-2\"},React.createElement(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Username\",required:true,value:this.state.username,onChange:function onChange(e){return _this2.onChange('username',e);}})),React.createElement(\"div\",{className:\"col-12 mb-2\"},React.createElement(\"input\",{type:\"password\",className:\"form-control\",placeholder:\"Password\",required:true,value:this.state.password,onChange:function onChange(e){return _this2.onChange('password',e);}})),React.createElement(\"div\",{className:\"col-6\"},React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary btn-block\"},\"Login\")),React.createElement(\"div\",{className:\"col-6\"},React.createElement(Link,{to:'./register',className:\"btn btn-secondary btn-block\",tabIndex:\"-1\"},\"Register\"))));var message=React.createElement(\"span\",{style:{color:'red'}},this.state.error_msg);var logged_in=React.createElement(\"span\",{style:{color:'green'}},\"You're logged in\");return React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"div\",{className:\"card my-5 mx-auto\",style:{maxWidth:'500px'}},React.createElement(\"div\",{className:\"card-body\"},!this.state.logged_in?form:null,this.state.error_msg?message:null,this.state.logged_in?logged_in:null))));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return props;}}]);return Login;}(Component);export default Login;","map":{"version":3,"sources":["/Users/gabsacs/Desktop/Group1/src/client/src/pages/Login.js"],"names":["React","Component","Link","Login","props","handleSubmit","event","preventDefault","setState","error_msg","fetch","method","credentials","headers","body","JSON","stringify","username","state","password","then","res","json","ok","message","logged_in","onLogin","catch","err","console","error","history","push","attr","target","value","form","e","onChange","color","maxWidth"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\n\nclass Login extends Component {\n  constructor(props) {\n    super();\n    this.state = {\n      username: 'test_user',\n      password: 'AbsoluteUnit1134!',\n      error_msg: null,\n      logged_in: props.logged_in || false,\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    return props;\n  }\n\n  componentDidUpdate() {\n    if (this.state.logged_in) {\n      this.props.history.push('/');\n    }\n  }\n\n  handleSubmit = (event) => {\n    event.preventDefault();\n\n    this.setState({\n      error_msg: null,\n    });\n\n    fetch('/api/user/login', {\n      method: 'post',\n      credentials: 'include',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        username: this.state.username,\n        password: this.state.password,\n      }),\n    }).then(async (res) => {\n      const body = await res.json();\n      if (!res.ok) {\n        return this.setState({\n          error_msg: body.message,\n        });\n      }\n\n      this.setState({\n        logged_in: true,\n      });\n\n      this.props.onLogin(body); // user\n\n    }).catch(err => {\n      console.error(err);\n    });\n  }\n\n  onChange(attr, event) {\n    this.setState({\n      [attr]: event.target.value,\n    });\n  }\n\n  render() {\n    const form = <form onSubmit={this.handleSubmit}>\n        <div className=\"form-row\">\n          <div className=\"col-12 mb-2\">\n            <input type=\"text\" className=\"form-control\" placeholder=\"Username\" required\n              value={this.state.username} onChange={(e) => this.onChange('username', e)}/>\n          </div>\n          <div className=\"col-12 mb-2\">\n            <input type=\"password\" className=\"form-control\" placeholder=\"Password\" required\n              value={this.state.password} onChange={(e) => this.onChange('password', e)}/>\n          </div>\n          <div className=\"col-6\">\n            <button type=\"submit\" className=\"btn btn-primary btn-block\">Login</button>\n          </div>\n          <div className=\"col-6\">\n            <Link to={'./register'} className=\"btn btn-secondary btn-block\" tabIndex=\"-1\">\n              Register\n            </Link>\n          </div>\n        </div>\n      </form>;\n\n    const message = <span style={{color:'red'}}>{this.state.error_msg}</span>\n\n    const logged_in = <span style={{color:'green'}}>You're logged in</span>\n\n    return (\n      <div className=\"row\">\n        <div className=\"col\">\n          <div className=\"card my-5 mx-auto\" style={{maxWidth: '500px'}}>\n            <div className=\"card-body\">\n              {!this.state.logged_in ? form : null}\n              {this.state.error_msg ? message : null}\n              {this.state.logged_in ? logged_in : null} \n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}